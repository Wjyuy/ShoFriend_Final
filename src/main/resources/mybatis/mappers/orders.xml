<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.boot.dao.OrdersDAO">

	<select id="getOrdersByCustomer" resultType="com.boot.dto.OrdersDTO">
		SELECT * FROM orders WHERE customer_id = #{customer_id}
	</select>
	
	<insert id="insertOrder" parameterType="com.boot.dto.OrdersDTO"
            useGeneratedKeys="true" keyProperty="id" keyColumn="id">
        INSERT INTO orders (
            partner_order_id,
            customer_id,
            total_quantity,
            total_price,
            delivery_address,
            delivery_zipcode,
            delivery_memo,
            payment_method,
            payment_status,
            transaction_id,
            friend_order_id,
            posted,
            order_date,
            order_status
        ) VALUES (
            #{partnerOrderId},
            #{customerId},
            #{totalQuantity},
            #{totalPrice},
            #{deliveryAddress},
            #{deliveryZipcode},
            #{deliveryMemo},
            #{paymentMethod},
            #{paymentStatus},
            #{transactionId},
            #{friendOrderId},
            #{posted},
            NOW(),
            #{orderStatus}
        )
    </insert>

    <insert id="insertOrderItem" parameterType="com.boot.dto.OrderItemDTO">
        INSERT INTO order_items (
            order_id,
            product_id,
            quantity,
            sale_price
        ) VALUES (
            #{orderId},
            #{productId},
            #{quantity},
            #{salePrice}
        )
    </insert>

</mapper>
